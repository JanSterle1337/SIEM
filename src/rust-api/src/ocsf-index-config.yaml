version: 0.7
index_id: ocsf-events
doc_mapping:
  mode: dynamic # Allows new OCSF fields to be indexed automatically
  field_mappings:
    - name: category_uid
      type: u64
      fast: true
    - name: class_uid
      type: u64
      fast: true
    - name: disposition_id
      type: u64
      fast: true

    # Timestamp: Crucial for SIEM timelines
    - name: time
      type: datetime
      input_formats: ["unix_timestamp"]
      fast: true

    # Objects: Indexed as JSON for flexible querying
    - name: src_endpoint
      type: json
    - name: user
      type: json
    - name: metadata
      type: json

    # The raw message for full-text search
    - name: message
      type: text
      tokenizer: default

search_settings:
  default_search_fields: ["message", "src_endpoint.ip", "user.name"]